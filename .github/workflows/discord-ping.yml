name: Admin Auto Ping

on:
  schedule:
    - cron: "0 * * * *"
  workflow_dispatch:

jobs:
  ping:
    runs-on: ubuntu-latest
    steps:
      - name: Send Discord ping
        env:
          DISCORD_WEBHOOK: ${{ secrets.DISCORD_WEBHOOK }}
        run: |
          HOUR=$(TZ=America/New_York date +%H)

          MESSAGE=""

          if [ "$HOUR" = "08" ]; then
            MESSAGE="Admin Coverage 8-9 ET | VP: Dev | Active: Dreamy"
          fi

          if [ "$HOUR" = "09" ]; then
            MESSAGE="Admin Coverage 9-10 ET | VP: Dev | Active: Kat"
          fi

          if [ "$HOUR" = "10" ]; then
            MESSAGE="Admin Coverage 10-11 ET | VP: Dev | Active: Raina"
          fi

          if [ "$HOUR" = "13" ]; then
            MESSAGE="Admin Coverage 1-2 ET | VP: Rae | Trial: Yousra"
          fi

          if [ "$HOUR" = "15" ]; then
            MESSAGE="Admin Coverage 3-4 ET | VP: Dev | Trial: Rishi"
          fi

          if [ -z "$MESSAGE" ]; then
            echo "No message this hour"
            exit 0
          fi

          curl -X POST \
            -H "Content-Type: application/json" \
            -d "{\"content\":\"$MESSAGE\"}" \
            "$DISCORD_WEBHOOK"
